/*! For license information please see 26ef04f9.823f0e8b.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{138:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=a.a.createContext({}),s=function(e){var t=a.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},f=function(e){var t=s(e.components);return a.a.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),f=s(n),d=r,b=f["".concat(i,".").concat(d)]||f[d]||p[d]||o;return n?a.a.createElement(b,c(c({ref:t},u),{},{components:n})):a.a.createElement(b,c({ref:t},u))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var u=2;u<o;u++)i[u]=n[u];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},139:function(e,t,n){"use strict";e.exports=n(140)},140:function(e,t,n){"use strict";var r=n(141),a="function"==typeof Symbol&&Symbol.for,o=a?Symbol.for("react.element"):60103,i=a?Symbol.for("react.portal"):60106,c=a?Symbol.for("react.fragment"):60107,l=a?Symbol.for("react.strict_mode"):60108,u=a?Symbol.for("react.profiler"):60114,s=a?Symbol.for("react.provider"):60109,f=a?Symbol.for("react.context"):60110,p=a?Symbol.for("react.forward_ref"):60112,d=a?Symbol.for("react.suspense"):60113,b=a?Symbol.for("react.memo"):60115,m=a?Symbol.for("react.lazy"):60116,y="function"==typeof Symbol&&Symbol.iterator;function g(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O={};function j(e,t,n){this.props=e,this.context=t,this.refs=O,this.updater=n||h}function v(){}function S(e,t,n){this.props=e,this.context=t,this.refs=O,this.updater=n||h}j.prototype.isReactComponent={},j.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(g(85));this.updater.enqueueSetState(this,e,t,"setState")},j.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=j.prototype;var w=S.prototype=new v;w.constructor=S,r(w,j.prototype),w.isPureReactComponent=!0;var k={current:null},x=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function D(e,t,n){var r,a={},i=null,c=null;if(null!=t)for(r in void 0!==t.ref&&(c=t.ref),void 0!==t.key&&(i=""+t.key),t)x.call(t,r)&&!C.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var u=Array(l),s=0;s<l;s++)u[s]=arguments[s+2];a.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:o,type:e,key:i,ref:c,props:a,_owner:k.current}}function N(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var P=/\/+/g,_=[];function E(e,t,n,r){if(_.length){var a=_.pop();return a.result=e,a.keyPrefix=t,a.func=n,a.context=r,a.count=0,a}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function T(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>_.length&&_.push(e)}function $(e,t,n){return null==e?0:function e(t,n,r,a){var c=typeof t;"undefined"!==c&&"boolean"!==c||(t=null);var l=!1;if(null===t)l=!0;else switch(c){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case o:case i:l=!0}}if(l)return r(a,t,""===n?"."+R(t,0):n),1;if(l=0,n=""===n?".":n+":",Array.isArray(t))for(var u=0;u<t.length;u++){var s=n+R(c=t[u],u);l+=e(c,s,r,a)}else if(null===t||"object"!=typeof t?s=null:s="function"==typeof(s=y&&t[y]||t["@@iterator"])?s:null,"function"==typeof s)for(t=s.call(t),u=0;!(c=t.next()).done;)l+=e(c=c.value,s=n+R(c,u++),r,a);else if("object"===c)throw r=""+t,Error(g(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r,""));return l}(e,"",t,n)}function R(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function I(e,t){e.func.call(e.context,t,e.count++)}function M(e,t,n){var r=e.result,a=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,r,n,(function(e){return e})):null!=e&&(N(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,a+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(P,"$&/")+"/")+n)),r.push(e))}function U(e,t,n,r,a){var o="";null!=n&&(o=(""+n).replace(P,"$&/")+"/"),$(e,M,t=E(t,o,r,a)),T(t)}var L={current:null};function q(){var e=L.current;if(null===e)throw Error(g(321));return e}var A={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:k,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return U(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;$(e,I,t=E(null,null,t,n)),T(t)},count:function(e){return $(e,(function(){return null}),null)},toArray:function(e){var t=[];return U(e,t,null,(function(e){return e})),t},only:function(e){if(!N(e))throw Error(g(143));return e}},t.Component=j,t.Fragment=c,t.Profiler=u,t.PureComponent=S,t.StrictMode=l,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,t.cloneElement=function(e,t,n){if(null==e)throw Error(g(267,e));var a=r({},e.props),i=e.key,c=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(c=t.ref,l=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(s in t)x.call(t,s)&&!C.hasOwnProperty(s)&&(a[s]=void 0===t[s]&&void 0!==u?u[s]:t[s])}var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){u=Array(s);for(var f=0;f<s;f++)u[f]=arguments[f+2];a.children=u}return{$$typeof:o,type:e.type,key:i,ref:c,props:a,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:f,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=D,t.createFactory=function(e){var t=D.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:p,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:b,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return q().useCallback(e,t)},t.useContext=function(e,t){return q().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return q().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return q().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return q().useLayoutEffect(e,t)},t.useMemo=function(e,t){return q().useMemo(e,t)},t.useReducer=function(e,t,n){return q().useReducer(e,t,n)},t.useRef=function(e){return q().useRef(e)},t.useState=function(e){return q().useState(e)},t.version="16.13.1"},141:function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,t){for(var n,c,l=i(e),u=1;u<arguments.length;u++){for(var s in n=Object(arguments[u]))a.call(n,s)&&(l[s]=n[s]);if(r){c=r(n);for(var f=0;f<c.length;f++)o.call(n,c[f])&&(l[c[f]]=n[c[f]])}}return l}},75:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return s}));var r=n(2),a=n(6),o=(n(139),n(138)),i={id:"getting-started",title:"Getting Started",sidebar_label:"Getting Started"},c={unversionedId:"datastore/getting-started",id:"datastore/getting-started",isDocsHomePage:!1,title:"Getting Started",description:"Installing Offix DataStore",source:"@site/../docs/datastore/ref-getting-started.md",permalink:"/docs/next/datastore/getting-started",editUrl:"https://github.com/aerogear/offix/edit/master/website/../docs/datastore/ref-getting-started.md",version:"next",sidebar_label:"Getting Started",sidebar:"docs",previous:{title:"Introduction to Offix Datastore",permalink:"/docs/next/datastore/introduction"},next:{title:"Offix Datastore Concepts",permalink:"/docs/next/datastore/concepts"}},l=[{value:"Installing Offix DataStore",id:"installing-offix-datastore",children:[]},{value:"Using DataStore",id:"using-datastore",children:[{value:"Building your own GraphQL type",id:"building-your-own-graphql-type",children:[]},{value:"Configuring Datastore",id:"configuring-datastore",children:[]},{value:"Datastore Models",id:"datastore-models",children:[]}]},{value:"Schema Upgrades",id:"schema-upgrades",children:[]}],u={rightToc:l};function s(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"installing-offix-datastore"},"Installing Offix DataStore"),Object(o.b)("p",null,"Using ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.npmjs.com/package/offix-datastore"}),"npm"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"npm install offix-datastore\n")),Object(o.b)("p",null,"Or ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://yarnpkg.com/en/package/offix-datastore"}),"yarn"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"yarn add offix-datastore\n")),Object(o.b)("h2",{id:"using-datastore"},"Using DataStore"),Object(o.b)("h3",{id:"building-your-own-graphql-type"},"Building your own GraphQL type"),Object(o.b)("p",null,"Let's use the following sample schema for our app"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"type Task {\n    id: ID!\n    title: String\n    description: String\n    numberOfDaysLeft: Number\n}\n\n")),Object(o.b)("h3",{id:"configuring-datastore"},"Configuring Datastore"),Object(o.b)("p",null,"We have a ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/next/datastore/cli"}),"cli tool")," that generates DataStore config and Model JSON schema given a GraphQL schema.\n",Object(o.b)("inlineCode",{parentName:"p"},"DataStore")," accepts a config object and an optional ",Object(o.b)("inlineCode",{parentName:"p"},"CustomEngines"),", see ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"datastore-api"}),"api reference"),"."),Object(o.b)("h3",{id:"datastore-models"},"Datastore Models"),Object(o.b)("p",null,"To be able to store user tasks in DataStore, you need to create its DataStore model.\nThe DataStore model provides the API to perform CRUD operations on ",Object(o.b)("inlineCode",{parentName:"p"},"Task")," in the DataStore."),Object(o.b)("p",null,"Let's create the Task DataStore model."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Define its json schema. See ",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"model-api#Model-Json-Schema"}),"json schema reference"))),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-JSON",metastring:'title="/src/schema.json"',title:'"/src/schema.json"'}),'{\n  "Task": {\n    "name": "Task",\n    "version": 1,\n    "type": "object",\n    "primaryKey": "id",\n    "properties": {\n      "id": {\n        "type": "string",\n        "key": "id",\n        "isRequired": true,\n        "index": true,\n        "primary": true\n      },\n      "title": {\n        "type": "string",\n        "key": "title"\n      },\n      "numberOfDaysLeft": {\n        "type": "number",\n        "key": "numberOfDaysLeft"\n      }\n    }\n  },\n  ...\n}\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Define its ",Object(o.b)("inlineCode",{parentName:"li"},"interface"))),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/src/datastoreConfig.ts"',title:'"/src/datastoreConfig.ts"'}),"import { DataStore } from 'offix-datastore';\n\nexport interface Task {\n    id?: string;\n    title: string;\n    description: string;\n    numberOfDaysLeft: number;\n}\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Instantiate the ",Object(o.b)("inlineCode",{parentName:"li"},"TaskModel")," with the ",Object(o.b)("inlineCode",{parentName:"li"},"Task"),' interface and its json schema.\nWe will put all our datastore related config in "/src/datastoreConfig.ts"')),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/src/datastoreConfig.ts"',title:'"/src/datastoreConfig.ts"'}),'import { DataStore, DataSyncJsonSchema } from "offix-datastore";\nimport schema from "./schema.json";\n\nconst datastore = new DataStore({\n  dbName: "offix-datastore",\n  replicationConfig: {\n    client: {\n      url: "http://localhost:4000/graphql",\n      wsUrl: "ws://localhost:4000/graphql",\n    },\n    delta: { enabled: true },\n    mutations: { enabled: false },\n    liveupdates: { enabled: false }\n  }\n});\n\nexport const TaskModel = datastore.setupModel<Task>(schema.Task as DataSyncJsonSchema<Task>);\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Initialize the datastore")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/src/datastoreConfig.ts"',title:'"/src/datastoreConfig.ts"'}),"datastore.init();\n")),Object(o.b)("h2",{id:"schema-upgrades"},"Schema Upgrades"),Object(o.b)("p",null,"DataStore creates a table on the device for each model.\nWhen you push a new version of your app with models added, replaced or removed,\nthe tables for the new models won't be created on the client device and the unused tables(for removed models)\nwon't be deleted."),Object(o.b)("p",null,"To make DataStore acknowledge these changes, you need to increment the schema version."),Object(o.b)("p",null,"Using our sample app, suppose we add a ",Object(o.b)("inlineCode",{parentName:"p"},"SubTask"),' model, we need to increment\nthe schema version to trigger the creation of the "user_SubTask" table on the client device.'),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"DataStore")," constructor takes a schema version parameter(defaults to 1). "),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"const dataStore = new DataStore({\n  ...,\n  schemaVersion: 2\n});\n")))}s.isMDXComponent=!0}}]);